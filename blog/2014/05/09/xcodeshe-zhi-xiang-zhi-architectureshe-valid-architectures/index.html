
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Xcode设置项之Architectures和Valid Architectures - 王中周的个人博客</title>
  <meta name="author" content="王中周">

  
  <meta name="description" content="Xcode设置项之Architectures和Valid Architectures">
  <meta name="keywords" content="Architectures, Valid Architectures, Xcode设置">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://wangzz.github.io/blog/2014/05/09/xcodeshe-zhi-xiang-zhi-architectureshe-valid-architectures">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="王中周的个人博客" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

<script type="text/javascript">

function addBlankTargetForLinks () {

  $('a[href^="http"]').each(function(){

      $(this).attr('target', '_blank');

  });

}

$(document).bind('DOMNodeInserted', function(event) {

  addBlankTargetForLinks();

});

</script>
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">王中周的个人博客</a></h1>
  
    <h2>Stay hungry,stay foolish.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:wangzz.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About Me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Xcode设置项之Architectures和Valid Architectures</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-09T17:45:33+08:00" pubdate data-updated="true">May 9<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>iPhone指令集</h2>

<p>本文所讲的内容都是围绕iPhone的CPU指令集(想了解ARM指令集的同学请点击<a href="http://en.wikipedia.org/wiki/ARM_architecture">这里</a>)，现在先说说不同型号的iPhone都使用的是什么指令集：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ARMv8/ARM64 = iPhone 5s, iPad Air, Retina iPad Mini
</span><span class='line'>ARMv7s = iPhone 5, iPhone 5c, iPad 4
</span><span class='line'>ARMv7  = iPhone 3GS, iPhone 4, iPhone 4S, iPod 3G/4G/5G, iPad, iPad 2, iPad 3, iPad Mini  
</span><span class='line'>ARMv6  = iPhone, iPhone 3G, iPod 1G/2G</span></code></pre></td></tr></table></div></figure>


<h2>设置你想支持的指令集</h2>

<p>Xcode中关于生成二进制包指令集相关的设置项有以下三个：</p>

<!-- more -->


<h4>Architectures</h4>

<p>官方文档说明：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Space-separated list of identifiers. Specifies the architectures (ABIs, processor models) to which the binary is targeted. When this build setting specifies more than one architecture, the generated binary may contain object code for each of the specified architectures.</span></code></pre></td></tr></table></div></figure>


<p>该编译选项指定了工程将被编译成支持哪些指令集，支持指令集是通过编译生成对应的二进制数据包实现的，如果支持的指令集数目有多个，就会编译出包含多个指令集代码的数据包，造成最终编译的包很大。</p>

<h4>Valid Architectures</h4>

<p>官方文档说明：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Space-separated list of identifiers. Specifies the architectures for which the binary may be built. During the build, this list is intersected with the value of ARCHS build setting; the resulting list specifies the architectures the binary can run on. If the resulting architecture list is empty, the target generates no binary.</span></code></pre></td></tr></table></div></figure>


<p>该编译项指定可能支持的指令集，<strong>该列表和Architectures列表的交集，将是Xcode最终生成二进制包所支持的指令集</strong>。</p>

<p>比如，你的<code>Valid Architectures</code>设置的支持arm指令集版本有：<code>armv7/armv7s/arm64</code>，对应的<code>Architectures</code>设置的支持arm指令集版本有：<code>armv7s</code>，这时Xcode只会生成一个<code>armv7s</code>指令集的二进制包。</p>

<h4>Build Active Architecture Only</h4>

<p>官方文档说明：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Boolean value. Specifies whether the product includes only object code for the native architecture.</span></code></pre></td></tr></table></div></figure>


<p>该编译项用于设置是否只编译当前使用的设备对应的arm指令集。</p>

<p>当该选项设置成YES时，你连上一个<code>armv7</code>指令集的设备，就算你的<code>Valid Architectures</code>和<code>Architectures</code>都设置成<code>armv7/armv7s/arm64</code>，还是依然只会生成一个<code>armv7</code>指令集的二进制包。</p>

<p>当然该选项起作用的前提是<strong>你的Xcode必须成功连接了调试设备</strong>。如果你没有任何活跃设备，即Xcode没有成功连接调试设备，就算该设置项设置成YES依然还会编译<code>Valid Architectures</code>和<code>Architectures</code>指定的二进制包。</p>

<p>通常情况下，该编译选项在Debug模式都设成YES，Release模式都设成NO。</p>

<h2>说明</h2>

<ul>
<li>指令集都是可以向下兼容的</li>
</ul>


<p>比如，你的设备是armv7s指令集，那么它也可以兼容运行比armv7s版本低的指令集：armv7、armv6</p>

<ul>
<li>xcode对armv6指令集的支持</li>
</ul>


<p>Xcode4.5起不再支持armv6，Xcode4.5的release notes中明确指出：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Changes
</span><span class='line'>General: iOS
</span><span class='line'>
</span><span class='line'>This version of Xcode does not generate armv6 binaries. 12282156
</span><span class='line'>The minimum deployment target is iOS 4.3. 12282166</span></code></pre></td></tr></table></div></figure>


<h2>如何选择支持的指令集</h2>

<p>如果你的软件对安装包大小非常敏感，你可以减少安装包中的指令集数据包，而且这能达到立竿见影的效果。</p>

<p>我们的项目之前支持的指令集是armv7/armv7s，后来改成只支持armv7后，比原来小了10MB左右。目前AppStore上的一些知名应用，比如<code>百度地图</code>、<code>腾讯地图</code>通过反汇编工具查看后，也都只支持armv7指令集。</p>

<p>根据向下兼容原则，armv7指令集的应用是可以正常在支持armv7s/arm64指令集的机器上运行的。</p>

<p>不过对于armv7s/arm64指令集设备来说，使用运行armv7应用是会有一定的性能损失，不过这种损失有多大缺乏权威统计数据，个人认为是不会影响用户体验的。</p>

<h2>参考文档</h2>

<ul>
<li><p><a href="http://en.wikipedia.org/wiki/ARM_architecture">ARM architecture</a></p></li>
<li><p><a href="https://developer.apple.com/library/ios/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/0-Introduction/introduction.html#//apple_ref/doc/uid/TP40003931-CH1-SW1">Xcode Build Setting Reference</a></p></li>
<li><p><a href="http://justsee.iteye.com/blog/2009954">xcode5 arm64</a></p></li>
<li><p><a href="https://developer.apple.com/library/mac/releasenotes/DeveloperTools/RN-Xcode/xc4_release_notes/xc4_release_notes.html#//apple_ref/doc/uid/TP40001051-CH3-SW174">Xcode 4.5 Release Notes</a></p></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">王中周</span></span>

      








  


<time datetime="2014-05-09T17:45:33+08:00" pubdate data-updated="true">May 9<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/xcodesettings/'>XcodeSettings</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
  
  <!-- JiaThis Button BEGIN -->
<div class="jiathis_style_32x32">
	<a class="jiathis_button_qzone"></a>
	<a class="jiathis_button_tsina"></a>
	<a class="jiathis_button_tqq"></a>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_renren"></a>
	<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1394012284741689" charset="utf-8"></script>
<!-- JiaThis Button END -->
<!-- UJian Button BEGIN -->
	<div class="ujian-hook"></div>
	<script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js"></script>
<!-- UJian Button END -->

<!-- UY BEGIN -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js"></script>
<!-- UY END -->
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/04/28/custom-your-octopress-blog/" title="Previous Post: 自定义你的Octopress博客">&laquo; 自定义你的Octopress博客</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/05/19/jia-mi-ni-de-sqlite/" title="Next Post: 加密你的SQLite">加密你的SQLite &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>博主简介</h1>
<li>
<p>
	<span style="color:#222222;font-family:inherit;font-size:18px;font-style:inherit;font-weight:inherit;line-height:1.5;">曾就职于高阳科技、北京拉手网，现在高德地图；</span>
</p>
<p>
	<span style="font-family:inherit;font-style:inherit;font-weight:inherit;color:#222222;font-size:18px;line-height:1.5;">早期在<a href="http://blog.csdn.net/wzzvictory" target="_blank"><span style="color:#E53333;">CSND上写博客</span></a></span>
</p>
</li>
</section>
<section>
    <h1>新浪微博</h1>
    <ul id="weibo">
    <li>
    	
<iframe width="100%" height="130" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=0&skin=2&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=1734555471&verifier=6c6f0bb3&dpc=1"></iframe>

</li>
    </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/19/jia-mi-ni-de-sqlite/">加密你的SQLite</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/05/09/xcodeshe-zhi-xiang-zhi-architectureshe-valid-architectures/">Xcode设置项之Architectures和Valid Architectures</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/28/custom-your-octopress-blog/">自定义你的Octopress博客</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/25/githubyou-xiu-xiang-mu-ios/">github优秀开源项目大全-iOS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/02/ru-he-pei-zhi-rang-ni-de-octopressbo-ke-zai-duo-tai-macshang-tong-shi-shi-yong/">让你的Octopress博客在多台Mac上同时使用</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/database/'>Database (1)</a></li>
<li class='category'><a href='/blog/categories/octopress/'>Octopress (2)</a></li>
<li class='category'><a href='/blog/categories/xcodesettings/'>XcodeSettings (1)</a></li>
<li class='category'><a href='/blog/categories/opensource/'>opensource (1)</a></li>

  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - 王中周 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>


<p>
<script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F9975063b89c363c67eac651132751ee6' type='text/javascript'%3E%3C/script%3E"));
    </script>

</p></footer>
  











</body>
</html>
