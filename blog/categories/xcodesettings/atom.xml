<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: XcodeSettings | 王中周的技术博客]]></title>
  <link href="http://wangzz.github.io/blog/categories/xcodesettings/atom.xml" rel="self"/>
  <link href="http://wangzz.github.io/"/>
  <updated>2014-05-25T17:46:50+08:00</updated>
  <id>http://wangzz.github.io/</id>
  <author>
    <name><![CDATA[王中周]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[iOS模拟器Custom Location被重置解决方案]]></title>
    <link href="http://wangzz.github.io/blog/2014/05/25/iosmo-ni-qi-custom-locationbei-zhong-zhi-jie-jue-fang-an/"/>
    <updated>2014-05-25T17:29:18+08:00</updated>
    <id>http://wangzz.github.io/blog/2014/05/25/iosmo-ni-qi-custom-locationbei-zhong-zhi-jie-jue-fang-an</id>
    <content type="html"><![CDATA[<h2>问题说明</h2>

<p>在做地图类应用时，经常需要用到位置模拟功能。iOS模拟器提供了该功能，我们可以设置指定的经纬度，选中模拟器后，按照以下菜单层次进入即可设置：</p>

<p><code>
Debug --&gt; Location --&gt; Custom Location
</code>
但是该功能存在的问题是设置完经纬度每次重新run程序，或者重启模拟器的时候都有可能使之前设置的Location状态从<code>Custom Location</code>变成<code>None</code>，导致设置的经纬度信息无效。</p>

<p>因此经常需要重新选择<code>Custom Location</code>，对于每天需要run程序n次的我们来说苦不堪言&hellip;</p>

<h2>解决方案</h2>

<p>好在Xcode的target设置项中提供了设置位置信息的方法，允许我们使用GPX文件来设置自定义位置信息，步骤如下：</p>

<!-- more -->


<ul>
<li>获取GPX文件</li>
</ul>


<p>GPX（GPS eXchange Format, GPS交换格式)是一个XML格式,为应用软件设计的通用GPS数据格式。它可以用来描述路点、轨迹、路程。（来自<a href="http://zh.wikipedia.org/wiki/GPX">维基百科</a>）</p>

<p>我们可以通过第三方网站：<a href="http://gpx-poi.com/">gpx-poi.com</a>来生成一个GPX文件，生成过程也很方便：</p>

<p>在网站左上角拖动地图到指定位置，鼠标单击后会出现一个红色标注，同时地图下方会显示出标注的经纬度数据；</p>

<p>点击地图下方的<code>Update</code>按钮就能将经纬度信息更新到界面右侧的位置信息描述表格中；</p>

<p>然后将界面拉到底部，填写GPX文件名称，选择操作系统型号；</p>

<p>点击<code>Create</code>按钮即可生成一个XML格式的GPX文件，再点击<code>Download</code>按钮即可将文件下载到本地。</p>

<p>生成的GPX文件大概是这样：</p>

<p><code>
&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;gpxxmlns="http://www.topografix.com/GPX/1/1"xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"version="1.1" creator="gpx-poi.com"&gt;
   &lt;wpt lat=“41.988810" lon="116.474828"&gt;      &lt;time&gt;2014-05-25T07:27:53Z&lt;/time&gt;      &lt;name&gt;A&lt;/name&gt;   &lt;/wpt&gt;
   &lt;/gpx&gt;
</code></p>

<ul>
<li>导入GPX文件</li>
</ul>


<p>在Xcode中选中指定target，按以下菜单层次进入：</p>

<p><code>
Edite Scheme --&gt;  Options --&gt;  Default Location --&gt;  Add GPX File to Project
</code>
（此时必须保证<code>Allow Location Simulation</code>选项是选中的，该设置项默认选中。）</p>

<p>如图所示：</p>

<p><img src="http://wangzz.github.io/images/article3/default_location.png" width="703" height="475"></p>

<p>即可将刚才生成并下载到本地的GPX文件添加到工程里。从此以后不管是重新run程序还是重启模拟器都可以在程序启动的时候定到位。</p>

<p>不过这种做法有个缺点，我在实际使用的时候发现设置完<code>Default Location</code>以后，真机的位置信息也会被更改成设置的位置！！！还请记得在软件发布时删除该设置项。</p>

<h2>参考文档</h2>

<ul>
<li><a href="http://stackoverflow.com/questions/19719276/ios-simulator-reverts-location-setting">iOS Simulator Reverts Location Setting</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Xcode设置项之Architectures和Valid Architectures]]></title>
    <link href="http://wangzz.github.io/blog/2014/05/09/xcodeshe-zhi-xiang-zhi-architectureshe-valid-architectures/"/>
    <updated>2014-05-09T17:45:33+08:00</updated>
    <id>http://wangzz.github.io/blog/2014/05/09/xcodeshe-zhi-xiang-zhi-architectureshe-valid-architectures</id>
    <content type="html"><![CDATA[<h2>iPhone指令集</h2>

<p>本文所讲的内容都是围绕iPhone的CPU指令集(想了解ARM指令集的同学请点击<a href="http://en.wikipedia.org/wiki/ARM_architecture">这里</a>)，现在先说说不同型号的iPhone都使用的是什么指令集：</p>

<p><code>
ARMv8/ARM64 = iPhone 5s, iPad Air, Retina iPad Mini
ARMv7s = iPhone 5, iPhone 5c, iPad 4
ARMv7  = iPhone 3GS, iPhone 4, iPhone 4S, iPod 3G/4G/5G, iPad, iPad 2, iPad 3, iPad Mini  
ARMv6  = iPhone, iPhone 3G, iPod 1G/2G
</code></p>

<h2>设置你想支持的指令集</h2>

<p>Xcode中关于生成二进制包指令集相关的设置项有以下三个：</p>

<!-- more -->


<h4>Architectures</h4>

<p>官方文档说明：</p>

<p><code>
Space-separated list of identifiers. Specifies the architectures (ABIs, processor models) to which the binary is targeted. When this build setting specifies more than one architecture, the generated binary may contain object code for each of the specified architectures.
</code></p>

<p>该编译选项指定了工程将被编译成支持哪些指令集，支持指令集是通过编译生成对应的二进制数据包实现的，如果支持的指令集数目有多个，就会编译出包含多个指令集代码的数据包，造成最终编译的包很大。</p>

<h4>Valid Architectures</h4>

<p>官方文档说明：</p>

<p><code>
Space-separated list of identifiers. Specifies the architectures for which the binary may be built. During the build, this list is intersected with the value of ARCHS build setting; the resulting list specifies the architectures the binary can run on. If the resulting architecture list is empty, the target generates no binary.
</code></p>

<p>该编译项指定可能支持的指令集，<strong>该列表和Architectures列表的交集，将是Xcode最终生成二进制包所支持的指令集</strong>。</p>

<p>比如，你的<code>Valid Architectures</code>设置的支持arm指令集版本有：<code>armv7/armv7s/arm64</code>，对应的<code>Architectures</code>设置的支持arm指令集版本有：<code>armv7s</code>，这时Xcode只会生成一个<code>armv7s</code>指令集的二进制包。</p>

<h4>Build Active Architecture Only</h4>

<p>官方文档说明：</p>

<p><code>
Boolean value. Specifies whether the product includes only object code for the native architecture.
</code>
该编译项用于设置是否只编译当前使用的设备对应的arm指令集。</p>

<p>当该选项设置成YES时，你连上一个<code>armv7</code>指令集的设备，就算你的<code>Valid Architectures</code>和<code>Architectures</code>都设置成<code>armv7/armv7s/arm64</code>，还是依然只会生成一个<code>armv7</code>指令集的二进制包。</p>

<p>当然该选项起作用的前提是<strong>你的Xcode必须成功连接了调试设备</strong>。如果你没有任何活跃设备，即Xcode没有成功连接调试设备，就算该设置项设置成YES依然还会编译<code>Valid Architectures</code>和<code>Architectures</code>指定的二进制包。</p>

<p>通常情况下，该编译选项在Debug模式都设成YES，Release模式都设成NO。</p>

<h2>说明</h2>

<ul>
<li>指令集都是可以向下兼容的</li>
</ul>


<p>比如，你的设备是armv7s指令集，那么它也可以兼容运行比armv7s版本低的指令集：armv7、armv6</p>

<ul>
<li>xcode对armv6指令集的支持</li>
</ul>


<p>Xcode4.5起不再支持armv6，Xcode4.5的release notes中明确指出：</p>

<p>```
Changes
General: iOS</p>

<p>This version of Xcode does not generate armv6 binaries. 12282156
The minimum deployment target is iOS 4.3. 12282166
```</p>

<h2>如何选择支持的指令集</h2>

<p>如果你的软件对安装包大小非常敏感，你可以减少安装包中的指令集数据包，而且这能达到立竿见影的效果。</p>

<p>我们的项目之前支持的指令集是armv7/armv7s，后来改成只支持armv7后，比原来小了10MB左右。目前AppStore上的一些知名应用，比如<code>百度地图</code>、<code>腾讯地图</code>通过反汇编工具查看后，也都只支持armv7指令集。</p>

<p>根据向下兼容原则，armv7指令集的应用是可以正常在支持armv7s/arm64指令集的机器上运行的。</p>

<p>不过对于armv7s/arm64指令集设备来说，使用运行armv7应用是会有一定的性能损失，不过这种损失有多大缺乏权威统计数据，个人认为是不会影响用户体验的。</p>

<h2>参考文档</h2>

<ul>
<li><p><a href="http://en.wikipedia.org/wiki/ARM_architecture">ARM architecture</a></p></li>
<li><p><a href="https://developer.apple.com/library/ios/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/0-Introduction/introduction.html#//apple_ref/doc/uid/TP40003931-CH1-SW1">Xcode Build Setting Reference</a></p></li>
<li><p><a href="http://justsee.iteye.com/blog/2009954">xcode5 arm64</a></p></li>
<li><p><a href="https://developer.apple.com/library/mac/releasenotes/DeveloperTools/RN-Xcode/xc4_release_notes/xc4_release_notes.html#//apple_ref/doc/uid/TP40001051-CH3-SW174">Xcode 4.5 Release Notes</a></p></li>
</ul>

]]></content>
  </entry>
  
</feed>
